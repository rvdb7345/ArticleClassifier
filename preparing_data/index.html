<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Data Preparation - Documentation GNN ArticleClassifier</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Data Preparation";
        var mkdocs_page_input_path = "preparing_data.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Documentation GNN ArticleClassifier
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Index</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../project_installation/">Setting up</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../settings/">Configuring Settings</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">Data Preparation</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#processing-car-data-srcdata_preparationparse_car_xmlpy">Processing CAR data (src/data_preparation/parse_car_xml.py)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#processing-text-srcdata_preparationcreate_processed_datasetpy">Processing text (src/data_preparation/create_processed_dataset.py)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#creating-graph-networks-srcdata_preparationnetwork_generationcreate_network_type_networkspy">Creating graph networks (src/data_preparation/network_generation/create_{network_type}_networks.py)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#generating-a-data-split-srcdata_preparationcreate_data_splitpy">Generating a data split (src/data_preparation/create_data_split.py)</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../training/">Training</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../optimization/">Optimization</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Documentation GNN ArticleClassifier</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
      <li>Data Preparation</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="preparing-data">Preparing data</h1>
<p>This ReadMe explains how to prepare your data sources from the raw CARs to finetuned embedding text and graph networks.
The steps are given <strong>sequentially</strong>, so follow them in order, only skipping the steps that are not applicable for your
dataset as indicated.</p>
<p>The choice not to run everything in one single go is based on memory usage and possible errors in between.
However, if you are really set on running everything directly after each other, just create a simple bash script.
This avoids memory issues and doesn't require adding python code.</p>
<h2 id="processing-car-data-srcdata_preparationparse_car_xmlpy">Processing CAR data (<code>src/data_preparation/parse_car_xml.py</code>)</h2>
<p>Applies to: ['canary']</p>
<p>From the CAR data, we create a single CSV file to work with, extracting the data that we want.</p>
<p>Command: <code>python main.py --parse_car_xml</code></p>
<p>Input files: <code>data/raw/canary/original_xml_files/*.xml</code></p>
<p>Output files: <code>data/processed/canary/all_articles_diff_labels.csv</code></p>
<h2 id="processing-text-srcdata_preparationcreate_processed_datasetpy">Processing text (<code>src/data_preparation/create_processed_dataset.py</code>)</h2>
<p>Applies to: ['canary', 'litcovid']</p>
<p>Clean the text data and format the data to a uniform format</p>
<p>Command:</p>
<pre><code class="language-commandline">python main.py --process_data dataset
</code></pre>
<p>Input files: raw csv files (e.g. <code>data/processed/canary/all_articles_diff_labels.csv</code>)</p>
<p>Output files: <code>f'data/processed/{dataset}/{dataset}_articles_cleaned_{today}.csv'</code></p>
<h2 id="creating-graph-networks-srcdata_preparationnetwork_generationcreate_network_type_networkspy">Creating graph networks (<code>src/data_preparation/network_generation/create_{network_type}_networks.py</code>)</h2>
<p>Applies to: ['canary', 'litcovid']</p>
<p>Create Graph NetworkX structures from the processed data.</p>
<p>Command:</p>
<pre><code class="language-commandline">python main.py --generate_network dataset network_type
</code></pre>
<p>Implemented network types: ['author', 'keyword', 'label']</p>
<p>Input files: <code>f'data/processed/{dataset}/{dataset}_articles_cleaned_{today}.csv'</code></p>
<p>Output files: <code>f'data/processed/{dataset}/{network_type}_network.pickle'</code></p>
<h2 id="generating-a-data-split-srcdata_preparationcreate_data_splitpy">Generating a data split (<code>src/data_preparation/create_data_split.py</code>)</h2>
<p>Applies to: ['canary']</p>
<p>Generates a 64-16-20 data split if the dataset doesn't yet specify a data split.</p>
<p>Command:</p>
<pre><code class="language-commandline">python main.py --create_data_split dataset
</code></pre>
<h1 id="generating-embeddings">Generating Embeddings</h1>
<h2 id="generate-label-embedding-models-srcdata_preparationlabel_embeddingnode_to_vec_label_embeddingpy">Generate label embedding models (<code>src/data_preparation/label_embedding/node_to_vec_label_embedding.py</code>)</h2>
<p>Applies to: ['canary', 'litcovid']</p>
<p>Embed the label graph to use in the LAHA text embeddings.</p>
<p>Command:</p>
<pre><code class="language-commandline">python main.py --embed_labels dataset
</code></pre>
<p>Input files: <code>f'data/processed/{dataset}/{dataset}_label_network_weighted.pickle'</code></p>
<h2 id="training-text-embedding-models">Training text embedding models</h2>
<h3 id="finetuning-scibert-srcdata_preparationtext_embeddingtrain_scibert_modelpy">Finetuning SciBERT (<code>src/data_preparation/text_embedding/train_scibert_model.py</code>)</h3>
<p>Applies to: ['canary', 'litcovid']</p>
<p>Create a finetuned SciBERT model.
Set the file paths to the processed text files.</p>
<p>Command:</p>
<pre><code class="language-commandline">python main.py --train_scibert dataset
</code></pre>
<p>Input files: <code>f'data/processed/{dataset}/{dataset}_articles_cleaned_{today}.csv'</code></p>
<h3 id="training-scibert-laha-srcdata_preparationtext_embeddingtrain_bert_xml_modelpy">Training SciBERT-LAHA (<code>src/data_preparation/text_embedding/train_bert_xml_model.py</code>)</h3>
<p>Applies to: ['canary', 'litcovid']</p>
<p>Create a trained LAHA model.
Set the file paths to the processed text files and finetuned SciBERT model.</p>
<p>Command:</p>
<pre><code class="language-commandline">python main.py --train_xml_embedder dataset
</code></pre>
<p>Input files: <code>f'data/processed/{dataset}/{dataset}_articles_cleaned_{today}.csv'</code></p>
<h2 id="generate-text-embeddings">Generate Text Embeddings</h2>
<h3 id="scibert-inference-srcdata_preparationtext_embeddinginference_scibert_modelpy">SciBERT inference (<code>src/data_preparation/text_embedding/inference_scibert_model.py</code>)</h3>
<p>Applies to: ['canary', 'litcovid']</p>
<p>Generate text embeddings with the finetuned SciBERT model.
Set the file paths to the processed text files and finetuned SciBERT model.</p>
<p>Command:</p>
<pre><code class="language-commandline">python main.py --inference_scibert dataset
</code></pre>
<p>Input files: <code>f'data/processed/{dataset}/{dataset}_articles_cleaned_{today}.csv'</code></p>
<h3 id="scibert-laha-inference-srcdata_preparationtext_embeddinginference_bert_xml_modelpy">SciBERT-LAHA inference (<code>src/data_preparation/text_embedding/inference_bert_xml_model.py</code>)</h3>
<p>Applies to: ['canary', 'litcovid']</p>
<p>Generate text embeddings with the trained LAHA-SciBERT model.
Set the file paths to the processed text files and trained LAHA-SciBERT model.</p>
<p>Command:</p>
<pre><code class="language-commandline">python main.py --inference_xml_embedder dataset
</code></pre>
<p>Input files: <code>f'data/processed/{dataset}/{dataset}_articles_cleaned_{today}.csv'</code></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../settings/" class="btn btn-neutral float-left" title="Configuring Settings"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../training/" class="btn btn-neutral float-right" title="Training">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../settings/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../training/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
